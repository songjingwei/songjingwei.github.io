import{G as u,C as d,b5 as m,b6 as f,d as h}from"./index-CybXJaB_.js";import{a as v}from"./gamesList-ReSE-9Jj.js";const b=u()(d(m(o=>({isCloudGaming:!1,setIsCloudGaming:e=>o({isCloudGaming:e},!1,"setIsCloudGaming")}),{name:"cloud-game-storage",storage:f(()=>localStorage)}),{name:"Gamehub/cloudGameStore"})),G=o=>{const{data:e,isLoading:l,error:n}=h({queryKey:["gameDetails",o],queryFn:async()=>{if(!o)throw new Error("游戏ID不存在");return(await v(o)).data},enabled:!!o,staleTime:18e5}),c=()=>{if(!e)return{title:"加载中...",tags:[],developer:"未知",publisher:"未知",releaseDate:"未知",platform:[],score:100,description:"",startUp:[]};const t=[];if(e.top_category_tags&&typeof e.top_category_tags=="object"){const s=Object.values(e.top_category_tags).filter(a=>a&&a.trim());t.push(...s)}t.length===0&&t.push("暂无标签");let i=[];e.filter&&typeof e.filter=="object"?i=Object.keys(e.filter).filter(s=>s.startsWith("gamePlatform-")):console.log("没有filter数据");const r=e.release_date||"待发布";return{title:e.name||"未知游戏",tags:t,developer:e.company||"未知开发商",publisher:e.publishers||"未知发行商",releaseDate:r,platform:i,score:e.review_percentage!==void 0&&e.review_percentage!==null?e.review_percentage:100,description:e.description||"",videoUrl:e.video_url||void 0,steamAppid:e.steam_appid||void 0,startUp:e.start_up||[]}},p=()=>{if(!e)return[];const t=[],i=r=>r&&r.startsWith("http")&&(r.includes(".jpg")||r.includes(".jpeg")||r.includes(".png")||r.includes(".webp")||r.includes(".gif"));return e.video_url&&e.video_url.startsWith("http")&&(t.push({id:"video-1",type:"video",src:e.video_url,title:e.name,subtitle:"游戏预告片"}),console.log("添加视频项:",e.video_url)),e.screenshot&&e.screenshot.split(",").map(s=>s.trim()).filter(s=>s&&i(s)).forEach((s,a)=>{t.push({id:`screenshot-${a}`,type:"image",src:s,title:e.name,subtitle:`游戏截图 ${a+1}`}),console.log(`添加截图 ${a+1}:`,s)}),console.log("构建的媒体项目总数:",t.length),console.log("媒体项目列表:",t),t},g=()=>e?e.description?e.description:"<p>暂无游戏详情</p>":"<p>游戏详情内容加载中...</p>";return{gameData:e||null,loading:l,error:n?n.message:null,getGameInfoForPanel:c,getMediaItems:p,getGameSummaryContent:g}};export{G as a,b as u};
