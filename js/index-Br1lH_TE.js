import{j as e,m as I,ak as k,a2 as b,af as B,b as z,al as q,R as A,r as x,am as S,aj as M}from"./index-CybXJaB_.js";import{A as L}from"./ArrowLeftIcon-udHCKLBD.js";const T="_container_kzqe3_1",D="_header_kzqe3_19",V="_backButton_kzqe3_36",F="_headerTitle_kzqe3_53",P="_content_kzqe3_65",H="_errorMessage_kzqe3_73",R="_feedbackIdSection_kzqe3_82",W="_feedbackIdText_kzqe3_89",E="_copyButton_kzqe3_99",Z="_replySection_kzqe3_110",O="_feedbackSection_kzqe3_111",$="_sectionHeader_kzqe3_117",G="_avatar_kzqe3_123",U="_sectionTitle_kzqe3_132",Y="_sectionTime_kzqe3_141",J="_sectionContent_kzqe3_151",K="_contentWrapper_kzqe3_170",Q="_textContent_kzqe3_179",X="_imagesGrid_kzqe3_190",ee="_imgItem_kzqe3_196",se="_imgMask_kzqe3_211",te="_mediaImage_kzqe3_216",ne="_mediaVideo_kzqe3_217",ae="_imgActions_kzqe3_239",ie="_imgActionBtn_kzqe3_247",ce="_previewOverlay_kzqe3_258",oe="_previewContainer_kzqe3_271",re="_previewCloseButton_kzqe3_287",le="_previewContent_kzqe3_324",de="_previewImage_kzqe3_335",me="_previewVideo_kzqe3_343",he="_filePreview_kzqe3_377",xe="_fileIcon_kzqe3_390",ve="_fileName_kzqe3_395",s={container:T,header:D,backButton:V,headerTitle:F,content:P,errorMessage:H,feedbackIdSection:R,feedbackIdText:W,copyButton:E,replySection:Z,feedbackSection:O,sectionHeader:$,avatar:G,sectionTitle:U,sectionTime:Y,sectionContent:J,contentWrapper:K,textContent:Q,imagesGrid:X,imgItem:ee,imgMask:se,mediaImage:te,mediaVideo:ne,imgActions:ae,imgActionBtn:ie,previewOverlay:ce,previewContainer:oe,previewCloseButton:re,previewContent:le,previewImage:de,previewVideo:me,filePreview:he,fileIcon:xe,fileName:ve},m=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.4675 8.00033C10.4675 9.36263 9.36302 10.4671 8.00069 10.4671C6.63841 10.4671 5.53389 9.36261 5.53389 8.00033C5.5339 6.63804 6.63841 5.53355 8.00069 5.53353C9.36302 5.53353 10.4675 6.63803 10.4675 8.00033ZM9.13415 8.00033C9.13415 7.37441 8.62662 6.86686 8.00069 6.86686C7.37479 6.86688 6.86723 7.37442 6.86723 8.00033C6.86723 8.62623 7.37478 9.13377 8.00069 9.13379C8.62662 9.13379 9.13415 8.62625 9.13415 8.00033Z",fill:"#BAD7F5"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.00069 3.13379C11.0036 3.13379 13.4165 4.95056 14.5189 7.50814L14.6218 7.75814L14.642 7.81673C14.682 7.95653 14.6751 8.10665 14.6218 8.24316C13.5719 10.9313 11.1004 12.8669 8.00069 12.8669C4.901 12.8668 2.42949 10.9313 1.3796 8.24316C1.31874 8.08733 1.31882 7.91399 1.3796 7.75814L1.48246 7.50814C2.5848 4.95055 4.99777 3.13381 8.00069 3.13379ZM8.00069 4.46712C5.59536 4.46714 3.64026 5.90282 2.72204 8.00033C3.64026 10.0979 5.59536 11.5335 8.00069 11.5335C10.4059 11.5335 12.3604 10.0977 13.2787 8.00033C12.3604 5.90295 10.4059 4.46712 8.00069 4.46712Z",fill:"#BAD7F5"})]}),N=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 3.9127C4 2.84778 5.18717 2.21261 6.07324 2.80333L12.2041 6.89122C12.9958 7.41898 12.9958 8.5822 12.2041 9.10997L6.07324 13.1969C5.18717 13.7876 4 13.1524 4 12.0875V3.9127ZM5.33301 12.0875L11.4648 8.00059L5.33301 3.9127V12.0875Z",fill:"#BAD7F5"})}),pe=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("path",{d:"M9.33301 3.84603V3.23014C9.33293 3.08064 9.27337 2.93743 9.16764 2.83171C9.06184 2.72593 8.91822 2.66634 8.76855 2.66634H3.23014C3.08064 2.66642 2.93743 2.72599 2.83171 2.83171C2.72599 2.93743 2.66642 3.08064 2.66634 3.23014V8.76855C2.66634 8.91822 2.72593 9.06184 2.83171 9.16764C2.93743 9.27337 3.08064 9.33293 3.23014 9.33301H3.84603C4.21413 9.33312 4.5127 9.63154 4.5127 9.99967C4.5127 10.3678 4.21413 10.6662 3.84603 10.6663H3.23014C2.72702 10.6663 2.24477 10.4661 1.889 10.1104C1.53316 9.75449 1.33301 9.27182 1.33301 8.76855V3.23014C1.33309 2.72702 1.53323 2.24477 1.889 1.889C2.24477 1.53323 2.72702 1.33309 3.23014 1.33301H8.76855C9.27182 1.33301 9.75449 1.53316 10.1104 1.889C10.4661 2.24477 10.6663 2.72702 10.6663 3.23014V3.84603C10.6662 4.21413 10.3678 4.5127 9.99967 4.5127C9.63154 4.5127 9.33312 4.21413 9.33301 3.84603Z",fill:"#BAD7F5",fillOpacity:"0.65"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.6663 12.6663C14.6663 13.7709 13.7709 14.6663 12.6663 14.6663H7.33301C6.22844 14.6663 5.33301 13.7709 5.33301 12.6663V7.33301C5.33301 6.22844 6.22844 5.33301 7.33301 5.33301H12.6663C13.7709 5.33301 14.6663 6.22844 14.6663 7.33301V12.6663ZM13.333 7.33301C13.333 6.96482 13.0345 6.66634 12.6663 6.66634H7.33301C6.96482 6.66634 6.66634 6.96482 6.66634 7.33301V12.6663C6.66634 13.0345 6.96482 13.333 7.33301 13.333H12.6663C13.0345 13.333 13.333 13.0345 13.333 12.6663V7.33301Z",fill:"#BAD7F5",fillOpacity:"0.65"})]}),je=({feedback:n,onPreviewMedia:i})=>{const d=I(t=>t.currentUser),h=(d==null?void 0:d.avatar)||k,v=()=>{b(String(n.id))},u=n.conversations&&n.conversations.length>0;return e.jsxs("div",{className:s.content,children:[e.jsxs("div",{className:s.feedbackIdSection,children:[e.jsxs("span",{className:s.feedbackIdText,children:["åé¦ˆå•å·: ",n.id]}),e.jsx("button",{className:s.copyButton,onClick:v,children:e.jsx(pe,{})})]}),u?n.conversations.map(t=>e.jsxs("div",{className:t.type==="user"?s.feedbackSection:s.replySection,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("img",{src:t.type==="user"?h:k,alt:"avatar",className:s.avatar}),e.jsx("span",{className:s.sectionTitle,children:t.type==="user"?"æ‚¨æäº¤çš„åé¦ˆå†…å®¹":"ç›–ä¸–æ¸¸æˆå›å¤"}),e.jsx("span",{className:s.sectionTime,children:t.time})]}),e.jsx("div",{className:s.sectionContent,children:e.jsxs("div",{className:s.contentWrapper,children:[e.jsx("div",{className:s.textContent,children:t.content}),t.attachment&&t.attachment.length>0&&e.jsx("div",{className:s.imagesGrid,children:t.attachment.map((a,p)=>e.jsxs("div",{className:s.imgItem,children:[a.type==="image"?e.jsx("img",{src:a.url,alt:"å›¾ç‰‡",className:s.mediaImage}):a.type==="video"?e.jsx("video",{src:a.url,className:s.mediaVideo,controls:!1}):e.jsxs("div",{className:s.filePreview,children:[e.jsx("div",{className:s.fileIcon,children:"ğŸ“„"}),e.jsx("div",{className:s.fileName,children:"æŸ¥çœ‹æ–‡ä»¶"})]}),e.jsx("div",{className:s.imgMask,children:e.jsx("div",{className:s.imgActions,children:e.jsx("button",{className:s.imgActionBtn,onClick:()=>a.type==="file"?window.open(a.url,"_blank"):i(a),children:a.type==="image"?e.jsx(m,{}):a.type==="video"?e.jsx(N,{}):e.jsx(m,{})})})})]},p))})]})})]},t.id)):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.feedbackSection,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("img",{src:h,alt:"avatar",className:s.avatar}),e.jsx("span",{className:s.sectionTitle,children:"æ‚¨æäº¤çš„åé¦ˆå†…å®¹"}),e.jsx("span",{className:s.sectionTime,children:n.date})]}),e.jsx("div",{className:s.sectionContent,children:e.jsxs("div",{className:s.contentWrapper,children:[e.jsx("div",{className:s.textContent,children:n.content}),n.userImages.length>0&&e.jsx("div",{className:s.imagesGrid,children:n.userImages.map((t,a)=>e.jsxs("div",{className:s.imgItem,children:[t.type==="image"?e.jsx("img",{src:t.url,alt:"ç”¨æˆ·å›¾ç‰‡",className:s.mediaImage}):t.type==="video"?e.jsx("video",{src:t.url,className:s.mediaVideo,controls:!1}):e.jsxs("div",{className:s.filePreview,children:[e.jsx("div",{className:s.fileIcon,children:"ğŸ“„"}),e.jsx("div",{className:s.fileName,children:"æŸ¥çœ‹æ–‡ä»¶"})]}),e.jsx("div",{className:s.imgMask,children:e.jsx("div",{className:s.imgActions,children:e.jsx("button",{className:s.imgActionBtn,onClick:()=>t.type==="file"?window.open(t.url,"_blank"):i(t),children:t.type==="image"?e.jsx(m,{}):t.type==="video"?e.jsx(N,{}):e.jsx(m,{})})})})]},a))})]})})]}),n.replied&&e.jsxs("div",{className:s.replySection,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("img",{src:k,alt:"avatar",className:s.avatar}),e.jsx("span",{className:s.sectionTitle,children:"ç›–ä¸–æ¸¸æˆå›å¤"}),e.jsx("span",{className:s.sectionTime,children:n.replyTime||""})]}),e.jsx("div",{className:s.sectionContent,children:e.jsxs("div",{className:s.contentWrapper,children:[e.jsx("div",{className:s.textContent,children:n.replyContent}),n.replyImages.length>0&&e.jsx("div",{className:s.imagesGrid,children:n.replyImages.map((t,a)=>e.jsxs("div",{className:s.imgItem,children:[t.type==="image"?e.jsx("img",{src:t.url,alt:"å›å¤å›¾ç‰‡",className:s.mediaImage}):t.type==="video"?e.jsx("video",{src:t.url,className:s.mediaVideo,controls:!1}):e.jsxs("div",{className:s.filePreview,children:[e.jsx("div",{className:s.fileIcon,children:"ğŸ“„"}),e.jsx("div",{className:s.fileName,children:"æŸ¥çœ‹æ–‡ä»¶"})]}),e.jsx("div",{className:s.imgMask,children:e.jsx("div",{className:s.imgActions,children:e.jsx("button",{className:s.imgActionBtn,onClick:()=>t.type==="file"?window.open(t.url,"_blank"):i(t),children:t.type==="image"?e.jsx(m,{}):t.type==="video"?e.jsx(N,{}):e.jsx(m,{})})})})]},a))})]})})]})]})]})},ge=({media:n,onClose:i})=>n?B.createPortal(e.jsx("div",{className:s.previewOverlay,onClick:i,children:e.jsxs("div",{className:s.previewContainer,onClick:d=>d.stopPropagation(),children:[e.jsx("button",{className:s.previewCloseButton,onClick:i,children:e.jsx(L,{})}),e.jsx("div",{className:s.previewContent,children:n.type==="image"?e.jsx("img",{src:n.url,alt:"é¢„è§ˆ",className:s.previewImage}):e.jsx("video",{src:n.url,controls:!0,autoPlay:!0,className:s.previewVideo})})]})}),document.body):null,ke=()=>{const n=z(),{id:i}=q(),[d,h]=A.useState(null),[v,u]=x.useState(null),[t,a]=x.useState(!0),[p,j]=x.useState(""),C=async()=>{if(!i){j("ç¼ºå°‘åé¦ˆID"),a(!1);return}try{a(!0),j(""),console.log("æ‰‹æœºç«¯: è°ƒç”¨çœŸå®APIè·å–åé¦ˆè¯¦æƒ…, ID:",i);const c=await S(i);if(console.log("æ‰‹æœºç«¯: APIå“åº”æ•°æ®:",c),c.data&&c.data.feedback){const f=o=>{const l=new Date(o*1e3);return`${l.getFullYear()}/${String(l.getMonth()+1).padStart(2,"0")}/${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}:${String(l.getSeconds()).padStart(2,"0")}`},y=M(c.data.feedback),r=c.data.feedback,_=[];_.push({id:`feedback-${r.id}`,type:"user",content:r.content||"åé¦ˆå†…å®¹æè¿°...",time:f(r.created_at),timestamp:r.created_at,attachment:r.attachment||[]}),r.replies&&r.replies.length>0&&r.replies.forEach(o=>{_.push({id:o.id,type:o.user_type===1?"user":"official",content:o.contents,time:f(o.created_at),timestamp:o.created_at,attachment:o.attachment||[]})}),_.sort((o,l)=>o.timestamp-l.timestamp);const w={...y,conversations:_};u(w),console.log("æ‰‹æœºç«¯: åé¦ˆè¯¦æƒ…æ•°æ®è®¾ç½®å®Œæˆ:",w)}else j("æœªæ‰¾åˆ°å¯¹åº”çš„åé¦ˆä¿¡æ¯"),console.log("æ‰‹æœºç«¯: APIè¿”å›æ•°æ®ä¸ºç©º")}catch(c){console.error("æ‰‹æœºç«¯: è·å–åé¦ˆè¯¦æƒ…å¤±è´¥:",c),j(c.message||"è·å–åé¦ˆè¯¦æƒ…å¤±è´¥")}finally{a(!1)}},g=()=>{n(-1)};return x.useEffect(()=>{const c=()=>{window.innerWidth>1e3&&n("/")};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[n]),x.useEffect(()=>{C()},[i]),t?e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("button",{className:s.backButton,onClick:g,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#BAD7F5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:s.headerTitle,children:"åé¦ˆè¯¦æƒ…"})]}),e.jsx("div",{className:s.content,children:e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"åŠ è½½ä¸­..."})})]}):p?e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("button",{className:s.backButton,onClick:g,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#BAD7F5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:s.headerTitle,children:"åé¦ˆè¯¦æƒ…"})]}),e.jsxs("div",{className:s.content,children:[e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#ff4757"},children:p}),e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:e.jsx("button",{onClick:C,style:{padding:"8px 16px",background:"#BAD7F5",color:"#1a1a1a",border:"none",borderRadius:"4px",cursor:"pointer"},children:"é‡è¯•"})})]})]}):v?e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("button",{className:s.backButton,onClick:g,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#BAD7F5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:s.headerTitle,children:"åé¦ˆè¯¦æƒ…"})]}),e.jsx(je,{feedback:v,onPreviewMedia:h}),e.jsx(ge,{media:d,onClose:()=>h(null)})]}):e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("button",{className:s.backButton,onClick:g,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#BAD7F5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:s.headerTitle,children:"åé¦ˆè¯¦æƒ…"})]}),e.jsx("div",{className:s.content,children:e.jsx("div",{className:s.errorMessage,children:"æœªæ‰¾åˆ°å¯¹åº”çš„åé¦ˆä¿¡æ¯"})})]})};export{ke as default};
