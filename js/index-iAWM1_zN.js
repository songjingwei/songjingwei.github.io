import{b as w,l as j,m as y,r as n,o as C,aG as N,a3 as k,j as a,aH as S,aI as f,aJ as A,B as m}from"./index-CybXJaB_.js";function _(){const c=w(),i=j(),{currentUser:t,updateUserProfile:u}=y(),[r,p]=n.useState((t==null?void 0:t.avatar)||""),[d,v]=n.useState((t==null?void 0:t.avatar_colour)||"#98ffe8"),[l,h]=n.useState("笑脸"),o=C({mutationFn:N,onMutate:async e=>{await i.cancelQueries({queryKey:["currentUser"]});const x=i.getQueryData(["currentUser"]);return u({avatar:e.avatar,avatar_colour:e.avatar_colour}),{previousUser:x}},onError:(e,x,s)=>{k.error(`修改头像失败：${e.message}`),s!=null&&s.previousUser&&u(s.previousUser)},onSettled:()=>{i.invalidateQueries({queryKey:["currentUser"]})}}),b=()=>{r&&o.mutate({avatar:r,avatar_colour:d}),c(-1)},g=()=>{c(-1)};return a.jsxs("div",{className:"bg-[#10131d] overflow-clip relative rounded-[20px] size-full flex flex-col","data-name":"设置自适应-常规设置",children:[a.jsxs("div",{className:"flex flex-col w-full flex-grow min-h-[72px] px-5 gap-4",children:[a.jsx("div",{className:"w-full h-[72px] overflow-x-auto scrollbar-hide flex items-center justify-center",children:a.jsx(S,{activeColor:d,setActiveColor:v,avatar:r})}),a.jsxs("div",{className:"flex flex-col gap-4 w-full flex-grow min-h-0",children:[a.jsx("div",{className:"box-border content-stretch flex flex-row gap-5 items-center justify-start overflow-x-auto shrink-0 relative hide-scrollbar","data-name":"normalTabs",children:Object.keys(f).map(e=>a.jsxs("button",{type:"button",className:`relative pb-2 text-sm font-medium transition-colors duration-200 text-start whitespace-nowrap ${l===e?"text-[var(--Primary-5)] font-bold":"text-b100 hover:text-b75"}`,onClick:()=>h(e),children:[e,l===e&&a.jsx("img",{src:A,alt:"active",className:"absolute bottom-[1px] left-1/2 -translate-x-1/2 w-[40px] h-auto"})]},e))}),a.jsx("div",{className:"grid grid-cols-7 gap-x-9 gap-y-6 overflow-y-auto flex-grow py-1 px-1 pb-0 min-h-0",children:f[l].map(e=>a.jsx("button",{type:"button",className:`size-8 rounded-full cursor-pointer transition-all duration-200 focus:outline-none ${r===e?"ring-2 ring-offset-2 ring-offset-[#10131d] ring-white":"hover:scale-110"}`,onClick:()=>p(e),children:a.jsx("img",{src:e,alt:"avatar choice",className:"w-full h-full rounded-full"})},e))})]})]}),a.jsxs("div",{className:"bg-[#10131d] box-border content-stretch flex flex-row gap-3 items-start justify-start w-full p-5 shrink-0",children:[a.jsx(m,{variant:"gamesir",onClick:g,className:"backdrop-blur-[15px] backdrop-filter basis-0 bg-[rgba(186,215,245,0.1)] box-border content-stretch flex flex-row gap-2.5 grow items-center justify-center min-h-px min-w-px px-2.5 py-1.5 relative rounded-lg shrink-0",children:"取消"}),a.jsx(m,{variant:"gamesir-primary",onClick:b,disabled:o.isPending,className:"basis-0 bg-[#bad7f5] box-border content-stretch flex flex-row gap-2.5 grow items-center justify-center min-h-px min-w-px px-4 py-1.5 relative rounded-2xl shrink-0",children:o.isPending?"保存中...":"保存"})]})]})}export{_ as default};
