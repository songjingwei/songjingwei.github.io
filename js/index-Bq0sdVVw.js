import{m as b,r as n,j as a,at as N,as as V,a3 as i}from"./index-CybXJaB_.js";import{u as E}from"./useVerifyCodeMutation-yTHkI_Sq.js";const D=({verificationCode:g,onVerificationCodeChange:l,scene:v,currentMobile:h,currentZoneCode:j,disabled:c=!1,error:d})=>{const{currentUser:e}=b(),{mutate:w,isPending:u}=E(),[s,m]=n.useState(0);n.useEffect(()=>{let t;return s>0&&(t=setInterval(()=>{m(o=>o-1)},1e3)),()=>clearInterval(t)},[s]);const y=()=>{m(60)},C=async()=>{var p,x;const t=j||((p=e==null?void 0:e.mobile)==null?void 0:p.split("-")[0]),o=h||((x=e==null?void 0:e.mobile)==null?void 0:x.split("-")[1]);if(!o){i.error("无法获取用户手机号，请刷新重试。");return}w({scene:v,target:o,type:"sms",zone_code:t},{onSuccess:r=>{y(),i.success("验证码发送成功！"),r.data&&l(r.data)},onError:r=>{i.error(`发送验证码失败: ${r.message}`)}})},f=n.useMemo(()=>c||u||s>0,[c,u,s]);return a.jsxs("div",{className:"relative w-full",children:[a.jsxs("div",{className:"flex flex-row gap-3 items-center justify-start w-full",children:[a.jsx(N,{type:"text",placeholder:"输入短信中的验证码",variant:"gamesir",className:"flex-grow",value:g,onChange:t=>l(t.target.value)}),a.jsx(V,{onClick:f?void 0:C,disabled:f,className:"whitespace-pre",children:s>0?`${s}s后重试`:"获取验证码"})]}),d&&a.jsx("p",{className:"absolute text-[var(--Danger-5)] text-[10px] mt-1/2",children:d})]})};export{D as V};
