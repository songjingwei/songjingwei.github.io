import{r as u,b as A,j as a,a as g,E as L,aW as N}from"./index-CybXJaB_.js";import{C as y}from"./ContainerSkeleton-B-oo09NS.js";var T=new Map,v=new WeakMap,I=0,P=void 0;function _(e){return e?(v.has(e)||(I+=1,v.set(e,I.toString())),v.get(e)):"0"}function B(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?_(e.root):e[t]}`).toString()}function M(e){const t=B(e);let s=T.get(t);if(!s){const o=new Map;let c;const r=new IntersectionObserver(n=>{n.forEach(i=>{var d;const p=i.isIntersecting&&c.some(f=>i.intersectionRatio>=f);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=p),(d=o.get(i.target))==null||d.forEach(f=>{f(p,i)})})},e);c=r.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),s={id:t,observer:r,elements:o},T.set(t,s)}return s}function W(e,t,s={},o=P){if(typeof window.IntersectionObserver>"u"&&o!==void 0){const d=e.getBoundingClientRect();return t(o,{isIntersecting:o,target:e,intersectionRatio:typeof s.threshold=="number"?s.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:c,observer:r,elements:n}=M(s),i=n.get(e)||[];return n.has(e)||n.set(e,i),i.push(t),r.observe(e),function(){i.splice(i.indexOf(t),1),i.length===0&&(n.delete(e),r.unobserve(e)),n.size===0&&(r.disconnect(),T.delete(c))}}function z({threshold:e,delay:t,trackVisibility:s,rootMargin:o,root:c,triggerOnce:r,skip:n,initialInView:i,fallbackInView:d,onChange:p}={}){var f;const[l,h]=u.useState(null),b=u.useRef(p),[S,j]=u.useState({inView:!!i,entry:void 0});b.current=p,u.useEffect(()=>{if(n||!l)return;let x;return x=W(l,(C,R)=>{j({inView:C,entry:R}),b.current&&b.current(C,R),R.isIntersecting&&r&&x&&(x(),x=void 0)},{root:c,rootMargin:o,threshold:e,trackVisibility:s,delay:t},d),()=>{x&&x()}},[Array.isArray(e)?e.toString():e,l,c,o,r,n,s,d,t]);const w=(f=S.entry)==null?void 0:f.target,E=u.useRef(void 0);!l&&w&&!r&&!n&&E.current!==w&&(E.current=w,j({inView:!!i,entry:void 0}));const m=[h,S.inView,S.entry];return m.ref=m[0],m.inView=m[1],m.entry=m[2],m}const G=({imageUrl:e,title:t,activityTime:s,statusText:o,id:c,isLoading:r=!1})=>{const n=A();return a.jsxs("button",{className:g("flex flex-col items-center min-w-[calc(25%-15px)] cursor-pointer group","md:w-full"),onClick:()=>n(`/special/${c}`),type:"button",style:{gap:"12px",paddingBottom:"12px"},children:[a.jsx(y,{isLoading:r,delay:2e3,borderRadius:"16px",style:{width:"100%",aspectRatio:"275/158"},children:a.jsx(L,{className:"relative aspect-[275/158] z-10",borderRadius:"16px",blurRadius:"8px",children:a.jsx("img",{src:e,alt:t,className:"w-full h-full rounded-2xl z-10 object-cover transition-transform duration-300 group-hover:scale-110"})})}),a.jsx(y,{isLoading:r,delay:2e3,borderRadius:"8px",style:{width:"100%",height:"22px"},children:a.jsx("div",{className:"text-left",style:{color:"var(--100, #BAD7F5)",fontSize:"16px",fontStyle:"normal",fontWeight:700,lineHeight:"22px"},children:t})}),a.jsx(y,{isLoading:r,delay:2e3,borderRadius:"8px",style:{width:"100%",height:"16px"},children:a.jsx("div",{className:"text-left",style:{color:"var(--Primary-5_, #98FFE8)",fontFamily:'"Noto Sans SC"',fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px"},children:o==="进行中"?s:o})})]})},V="_specialGrid_1a4xz_2",$={specialGrid:V},D=""+new URL("../assets/special-1-DUv5CmAl.png",import.meta.url).href,F=""+new URL("../assets/special-2-CTPmf5Gx.png",import.meta.url).href,H=""+new URL("../assets/special-3-B_6kHE-T.png",import.meta.url).href,O=""+new URL("../assets/special-4-Bd8oNTud.png",import.meta.url).href,J=""+new URL("../assets/special-5-ByUdPnWW.png",import.meta.url).href,K=""+new URL("../assets/special-6-CZpNmJK6.png",import.meta.url).href,Z=""+new URL("../assets/special-7-DvcJyUJu.png",import.meta.url).href,U=[{id:"1",imageUrl:D,title:"下载《胡闹地牢》赢独家礼包、PS5...",activityTime:"2025/06/26 - 07/26",statusText:"进行中"},{id:"2",imageUrl:F,title:"即刻预约《溯回青空》！丰厚好礼你...",activityTime:"2025/06/26 - 07/26",statusText:"进行中"},{id:"3",imageUrl:H,title:"《星空》摄影大赛",activityTime:"2025/06/20 - 07/20",statusText:"进行中"},{id:"4",imageUrl:O,title:"《艾尔登法环》黄金树幽影内容更新",activityTime:"2025/06/15 - 07/15",statusText:"进行中"},{id:"5",imageUrl:J,title:"《黑神话：悟空》预购开启",activityTime:"2025/06/01 - 08/20",statusText:"长期活动"},{id:"6",imageUrl:K,title:"夏日游戏节特卖",activityTime:"2025/06/21 - 07/05",statusText:"已结束"},{id:"7",imageUrl:Z,title:"独立游戏开发者扶持计划",activityTime:"长期活动",statusText:"已结束"}],X=()=>{const[e,t]=u.useState([]),[s,o]=u.useState(!1),[c,r]=u.useState(!0),[n,i]=u.useState(!0),{ref:d,inView:p}=z({threshold:0}),f=u.useCallback(()=>{s||!c||(o(!0),setTimeout(()=>{const l=U.slice(e.length,e.length+16);console.log("加载更多数据: ",l),t(N(e,h=>{h.push(...l)})),e.length+l.length>=U.length&&r(!1),o(!1)},1e3))},[s,c,e]);return u.useEffect(()=>{f();const l=setTimeout(()=>{i(!1)},2e3);return()=>clearTimeout(l)},[f]),u.useEffect(()=>{p&&f()},[p,f]),a.jsxs("div",{className:"special-page",style:{paddingTop:window.innerWidth<1e3?"20px":"10px"},children:[a.jsx(y,{isLoading:n,delay:2e3,borderRadius:"8px",style:{width:"fit-content",height:"32px",marginBottom:"20px"},children:a.jsx("p",{className:g("text-xl text-left text-[var(--Title)]","font-bold leading-7","mb-5"),children:"专题活动"})}),a.jsx("div",{className:g("w-full",$.specialGrid),children:e.map((l,h)=>a.jsx(G,{...l,id:l.id,isLoading:n},`${l.title}-${h}`))}),a.jsxs("div",{ref:d,className:g("h-10 mt-5","text-xs text-center text-b65"),children:[s&&a.jsx("p",{children:"加载中..."}),!s&&!c&&a.jsx("p",{className:g("mt-[20px]"),children:"已经到底啦~"})]})]})};export{X as default};
