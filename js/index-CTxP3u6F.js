import{j as e,b as re,r as g,e as we,L as be,s as q,i as ue,R as ae,k as _e,l as Ie,m as Le,n as Te,d as J,o as me,p as Se,q as De,t as Re,v as Be,w as $e,x as ke,y as Me,z as He,A as Pe,D as Ee}from"./index-CybXJaB_.js";import{u as ie}from"./useInfiniteQuery-DSCseih0.js";import{L as Ne}from"./index-ZhyiOdCU.js";import{H as Fe}from"./HeartIcon-B-fRnsR9.js";import{P as Ce}from"./PLATFORM_ICON_MAP-pSA7Oz_G.js";import{N as T}from"./index-oH4-aH7I.js";import{S as ve}from"./index-BNj5bqZy.js";import{l as Ae}from"./load-parse-DuceWXsx.js";const ze="_lightEffect1_1bc6k_13",Ge="_header_1bc6k_18",Ue="_headerContent_1bc6k_23",Ve="_title_1bc6k_31",Ke="_searchInfo_1bc6k_44",Ze="_searchDescription_1bc6k_51",We="_tabContainer_1bc6k_63",Oe="_tabButton_1bc6k_71",qe="_active_1bc6k_87",Qe="_waveIcon_1bc6k_91",Je="_contentArea_1bc6k_110",Xe="_bottomText_1bc6k_123",Ye="_emptyState_1bc6k_137",et="_emptyIcon_1bc6k_147",tt="_emptyTitle_1bc6k_153",st="_emptyDescription_1bc6k_160",nt="_emptyContainer_1bc6k_168",f={lightEffect1:ze,header:Ge,headerContent:Ue,title:Ve,searchInfo:Ke,searchDescription:Ze,tabContainer:We,tabButton:Oe,active:qe,waveIcon:Qe,contentArea:Je,bottomText:Xe,emptyState:Ye,emptyIcon:et,emptyTitle:tt,emptyDescription:st,emptyContainer:nt},ce=({width:t=30,height:a=11,className:d=""})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:a,viewBox:"0 0 30 11",fill:"none",className:d,children:[e.jsx("path",{d:"M1.94685e-09 3.24436C6.30734e-05 1.28251 1.49714 -0.230292 3.18196 0.0289939L12.3568 1.44096C14.1112 1.71096 15.8889 1.71096 17.6433 1.44096L26.8181 0.0290065C28.5029 -0.230283 30 1.28258 30 3.24445C30 4.5048 29.3675 5.65106 28.378 6.18403L23.4575 8.83435C18.0966 11.7219 11.9032 11.7219 6.54225 8.83431L1.62199 6.18408C0.632444 5.65108 -4.05184e-05 4.50475 1.94685e-09 3.24436Z",fill:"url(#paint0_linear_6423_2287)"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"paint0_linear_6423_2287",x1:"30",y1:"5.5",x2:"0",y2:"5.5",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#4CB7B4"}),e.jsx("stop",{offset:"1",stopColor:"#4CB7B4",stopOpacity:"0"})]})})]}),at="_container_18etj_1",it="_gameList_18etj_6",ct="_gameItem_18etj_12",rt="_gameImage_18etj_33",ot="_gameInfo_18etj_44",lt="_gameTitle_18etj_53",dt="_gameDescription_18etj_116",H={container:at,gameList:it,gameItem:ct,gameImage:rt,gameInfo:ot,gameTitle:lt,gameDescription:dt},D=[];for(let t=0;t<256;++t)D.push((t+256).toString(16).slice(1));function mt(t,a=0){return(D[t[a+0]]+D[t[a+1]]+D[t[a+2]]+D[t[a+3]]+"-"+D[t[a+4]]+D[t[a+5]]+"-"+D[t[a+6]]+D[t[a+7]]+"-"+D[t[a+8]]+D[t[a+9]]+"-"+D[t[a+10]]+D[t[a+11]]+D[t[a+12]]+D[t[a+13]]+D[t[a+14]]+D[t[a+15]]).toLowerCase()}let he;const ht=new Uint8Array(16);function pt(){if(!he){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");he=crypto.getRandomValues.bind(crypto)}return he(ht)}const ut=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fe={randomUUID:ut};function gt(t,a,d){var o;if(fe.randomUUID&&!t)return fe.randomUUID();t=t||{};const i=t.random??((o=t.rng)==null?void 0:o.call(t))??pt();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,mt(i)}const K=(t,a)=>{if(!a||!t)return[t];const d=a.split("").map(I=>I.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),i=new RegExp(`(${d.join("|")})`,"gi"),o=[];let j=0,b=null;for(;b=i.exec(t),b!==null;)b.index>j&&o.push(t.substring(j,b.index)),o.push(e.jsx("span",{style:{color:"var(--Primary-5_)"},children:b[0]},gt())),j=i.lastIndex;return j<t.length&&o.push(t.substring(j)),o},xt=""+new URL("../assets/empty-Cv3M3WuW.svg",import.meta.url).href,O=()=>{const t=re();return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:xt,alt:"Á©∫Êï∞ÊçÆ"}),e.jsxs("p",{className:"text-xs text-b40 -mt-5",children:["ÂëÄ!¬†¬†Ê≤°ÊâæÂà∞Ê∏∏ÊàèÔºåÂéª",e.jsx("button",{type:"button",className:"text-[var(--Primary-5)] underline cursor-pointer bg-transparent border-none p-0",onClick:()=>t("/search"),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),t("/search"))},children:"ÊâæÊ∏∏Êàè"}),"ÁúãÁúãÂêßÔºÅ"]})]})})},yt=({query:t})=>{const a=re(),d=g.useRef(null),{gamePlatform:i}=we();console.log("Current game platform from store:",i);const o=c=>c?c.replace(/<[^>]*>/g,"").trim():"",{data:j,fetchNextPage:b,hasNextPage:I,isFetchingNextPage:r,isLoading:m,isError:S}=ie({queryKey:["searchGames",t],queryFn:async({pageParam:c})=>{const p=await q({text:t,type:1,page:c,page_size:10});if(p.code===200)return p.data;throw new Error("Search failed")},initialPageParam:1,getNextPageParam:c=>{if(c.page*c.page_size<c.total)return c.page+1},enabled:!!t.trim(),staleTime:1e3*60*30});g.useEffect(()=>{const c=new IntersectionObserver(p=>{p[0].isIntersecting&&I&&!r&&b()},{threshold:1});return d.current&&c.observe(d.current),()=>{d.current&&c.unobserve(d.current)}},[I,r,b]);const h=j!=null&&j.pages?j.pages.flatMap(c=>c.list.filter(p=>p.type===1).map(p=>p.data)):[],y=c=>{a(`/game/${c.id}`)};return m?e.jsx("div",{className:H.container,children:e.jsx("div",{className:H.gameList,children:Array.from({length:6}).map((c,p)=>e.jsxs("div",{className:H.gameItem,children:[e.jsx("div",{className:H.gameImage,children:e.jsx(T,{width:122,height:70,style:{borderRadius:"8px"}})}),e.jsxs("div",{className:H.gameInfo,children:[e.jsx(T,{width:204,height:20,style:{marginBottom:"8px"}}),e.jsx("div",{className:"flex items-center gap-2.5 text-sm",children:e.jsx(T,{width:312,height:16})}),e.jsx(T,{width:456,height:16,style:{marginTop:"8px"}})]})]},`skeleton-${p}`))})}):S?e.jsx("div",{className:H.error,children:"Âä†ËΩΩÊ∏∏ÊàèÂ§±Ë¥•"}):h.length===0?e.jsx(O,{}):e.jsxs("div",{className:H.container,children:[e.jsx("div",{className:H.gameList,children:h.map(c=>e.jsxs("div",{className:H.gameItem,onClick:()=>y(c),children:[e.jsx("div",{className:H.gameImage,children:e.jsx(T,{src:c.cover_image||"",alt:c.name,width:122,height:70,imgStyle:{borderRadius:"8px",objectFit:"cover"},style:{borderRadius:"8px"}})}),e.jsxs("div",{className:H.gameInfo,children:[e.jsx("h3",{className:H.gameTitle,children:K(c.name,t)}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[c.review_percentage&&c.review_percentage>=0?e.jsxs("div",{className:"flex items-center gap-1 text-white font-bold",children:[e.jsx(Fe,{}),e.jsxs("span",{className:"text-b65",children:[c.review_percentage,"%"]})]}):e.jsx("div",{className:"flex items-center gap-1 text-white font-bold text-xs",children:"ÊöÇÊó†ËØÑÂàÜ"}),e.jsx("div",{className:"flex items-center gap-2 text-xs",children:Object.values(c.top_category_tags).slice(0,3).map(p=>e.jsxs("div",{className:"flex items-center gap-2 text-b65",children:[e.jsx("span",{children:p}),e.jsx("div",{className:"w-[3px] h-[3px] rounded-full bg-b65"})]},p))}),e.jsx("div",{className:"flex items-center gap-1.5 text-b65",children:Object.keys((c==null?void 0:c.filter)||[]).filter(p=>p.startsWith("gamePlatform-")).map(p=>{const M=Ce[p];return M?g.createElement(M,{className:"w-3.5 h-3.5",key:p}):null})})]}),e.jsx("p",{className:H.gameDescription,children:K(o(c.title_desc||c.description)||"ÊöÇÊó†ÊèèËø∞",t)})]})]},c.id))}),I&&e.jsx("div",{ref:d,className:H.loadMore,children:r?e.jsx(be,{}):e.jsx(Ne,{})})]})},_t="_container_10bkv_1",vt="_activityList_10bkv_6",ft="_activityItem_10bkv_12",jt="_activityImage_10bkv_33",bt="_activityInfo_10bkv_51",Nt="_activityTitle_10bkv_60",Ct="_activityDescription_10bkv_131",L={container:_t,activityList:vt,activityItem:ft,activityImage:jt,activityInfo:bt,activityTitle:Nt,activityDescription:Ct},wt=t=>t?t.replace(/<[^>]*>/g,"").trim():"",It=({query:t})=>{const a=re(),d=g.useRef(null),{data:i,fetchNextPage:o,hasNextPage:j,isFetchingNextPage:b,isLoading:I,isError:r}=ie({queryKey:["searchActivities",t],queryFn:async({pageParam:h=1})=>{const y=await q({text:t,type:3,page:h,page_size:10});if(y.code===200)return y.data;throw new Error("Search failed")},initialPageParam:1,getNextPageParam:h=>{if(h.page*h.page_size<h.total)return h.page+1},enabled:!!t.trim(),staleTime:1e3*60*30});g.useEffect(()=>{const h=new IntersectionObserver(y=>{y[0].isIntersecting&&j&&!b&&o()},{threshold:1});return d.current&&h.observe(d.current),()=>{d.current&&h.unobserve(d.current)}},[j,b,o]);const m=i!=null&&i.pages?i.pages.flatMap(h=>h.list.filter(y=>y.type===3).map(y=>y.data)):[],S=h=>{a(`/special/${h.id||h.title}`)};return I?e.jsx("div",{className:L.container,children:e.jsx("div",{className:L.activityList,children:Array.from({length:8}).map((h,y)=>e.jsxs("div",{className:L.activityItem,children:[e.jsx("div",{className:L.activityImage,children:e.jsx(T,{width:122,height:70,style:{borderRadius:"8px"}})}),e.jsxs("div",{className:L.activityInfo,children:[e.jsx(T,{width:204,height:20,style:{marginBottom:"8px"}}),e.jsx(T,{width:312,height:16})]})]},`skeleton-${y}`))})}):r?e.jsx("div",{className:L.error,children:"Âä†ËΩΩÊ¥ªÂä®Â§±Ë¥•"}):m.length===0?e.jsxs("div",{className:L.emptyState,children:[e.jsx("div",{className:L.emptyIcon,children:"üéâ"}),e.jsx("h3",{className:L.emptyTitle,children:"Êú™ÊâæÂà∞Áõ∏ÂÖ≥Ê¥ªÂä®"}),e.jsx("p",{className:L.emptyDescription,children:"ËØïËØïÂÖ∂‰ªñÂÖ≥ÈîÆËØç"})]}):e.jsxs("div",{className:L.container,children:[e.jsx("div",{className:L.activityList,children:m.map(h=>e.jsxs("button",{className:L.activityItem,onClick:()=>S(h),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),S(h))},type:"button",tabIndex:0,children:[e.jsx("div",{className:L.activityImage,children:e.jsx(T,{src:h.content_img,alt:h.title,width:122,height:70,imgStyle:{borderRadius:"8px",objectFit:"cover"}})}),e.jsxs("div",{className:L.activityInfo,children:[e.jsx("h3",{className:L.activityTitle,children:K(h.title,t)}),e.jsx("p",{className:L.activityDescription,children:K(wt(h.desc)||"ÊöÇÊó†ÊèèËø∞",t)})]})]},h.id))}),j&&e.jsx("div",{ref:d,className:L.loadMore,children:b?e.jsx(be,{}):e.jsx(Ne,{})})]})},Lt="_container_1c11f_1",Tt="_headerBox_1c11f_18",St="_backButtons_1c11f_28",Dt="_searchBox_1c11f_56",Rt="_searchBar_1c11f_62",Bt="_searchBarFocused_1c11f_78",$t="_searchIcon_1c11f_83",kt="_searchInput_1c11f_98",Mt="_clearButton_1c11f_175",Ht="_searchHistory_1c11f_299",Pt="_historyTitle_1c11f_306",Et="_historyList_1c11f_316",Ft="_historyItem_1c11f_322",At="_gameRecommendations_1c11f_346",zt="_recommendationsHeader_1c11f_353",Gt="_recommendationsTitle_1c11f_360",Ut="_refreshBtn_1c11f_370",Vt="_refreshIcon_1c11f_403",Kt="_recommendationsList_1c11f_410",Zt="_recommendationItem_1c11f_416",Wt="_historyHeader_1c11f_470",Ot="_deleteButton_1c11f_477",qt="_tagWrapper_1c11f_497",Qt="_deleteIcon_1c11f_504",x={container:Lt,headerBox:Tt,backButtons:St,searchBox:Dt,searchBar:Rt,searchBarFocused:Bt,searchIcon:$t,searchInput:kt,clearButton:Mt,searchHistory:Ht,historyTitle:Pt,historyList:Et,historyItem:Ft,gameRecommendations:At,recommendationsHeader:zt,recommendationsTitle:Gt,refreshBtn:Ut,refreshIcon:Vt,recommendationsList:Kt,recommendationItem:Zt,historyHeader:Wt,deleteButton:Ot,tagWrapper:qt,deleteIcon:Qt},Jt=({className:t="",color:a="currentColor"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 16 16",fill:"none",className:t,children:e.jsx("path",{d:"M9.86148 2.86225C10.1218 2.60191 10.5445 2.60191 10.8048 2.86225C11.0648 3.12258 11.0649 3.54439 10.8048 3.80464L6.60951 7.99995L10.8048 12.1953C11.0649 12.4555 11.0648 12.8774 10.8048 13.1376C10.5445 13.398 10.1218 13.398 9.86148 13.1376L5.19545 8.47163C4.9351 8.21128 4.9351 7.78862 5.19545 7.52827L9.86148 2.86225Z",fill:a})}),Xt=({className:t="",color:a="currentColor"})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",className:t,children:[e.jsx("path",{d:"M5.83362 5.83325C6.15555 5.83341 6.41622 6.09408 6.41638 6.41602V9.33325C6.41623 9.65519 6.15556 9.91586 5.83362 9.91602C5.51154 9.91602 5.25015 9.65529 5.25 9.33325V6.41602C5.25016 6.09398 5.51155 5.83325 5.83362 5.83325Z",fill:a}),e.jsx("path",{d:"M7.58362 9.33325V6.41602C7.58378 6.09408 7.84444 5.83341 8.16638 5.83325C8.48845 5.83325 8.74984 6.09398 8.75 6.41602V9.33325C8.74985 9.65529 8.48845 9.91602 8.16638 9.91602C7.84444 9.91586 7.58377 9.65519 7.58362 9.33325Z",fill:a}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.99976 1.16602C8.42904 1.16602 8.83494 1.34564 9.12939 1.65479C9.42299 1.96303 9.58313 2.37555 9.58313 2.7998V3.49963H11.6664C11.9886 3.49963 12.25 3.76109 12.25 4.08325C12.2499 4.40529 11.9885 4.66602 11.6664 4.66602H11.6211L11.0811 11.2473C11.0695 11.6546 10.9124 12.0478 10.6299 12.3445C10.3355 12.6536 9.92954 12.8332 9.50024 12.8333H4.49976C4.07048 12.8332 3.66455 12.6536 3.37012 12.3445C3.08764 12.0478 2.93049 11.6546 2.91895 11.2473L2.37891 4.66602H2.33362C2.01154 4.66602 1.75015 4.40529 1.75 4.08325C1.75 3.76109 2.01145 3.49963 2.33362 3.49963H4.41687V2.7998C4.41687 2.37555 4.57704 1.96303 4.87061 1.65479C5.16509 1.34564 5.57094 1.16602 6.00024 1.16602H7.99976ZM4.08105 11.1516C4.08234 11.1674 4.08361 11.1836 4.08362 11.1995C4.08362 11.3321 4.1338 11.454 4.21521 11.5396C4.29573 11.6241 4.39877 11.6659 4.49976 11.666H9.50024C9.60125 11.6659 9.70424 11.6241 9.78479 11.5396C9.86619 11.454 9.91638 11.3321 9.91638 11.1995C9.91639 11.1836 9.91767 11.1674 9.91895 11.1516L10.4504 4.66602H3.54956L4.08105 11.1516ZM6.00024 2.33325C5.8992 2.33325 5.79627 2.37516 5.7157 2.45972C5.63419 2.5453 5.58325 2.6671 5.58325 2.7998V3.49963H8.41675V2.7998C8.41675 2.6671 8.36585 2.5453 8.2843 2.45972C8.20375 2.37515 8.1008 2.33325 7.99976 2.33325H6.00024Z",fill:a})]}),Yt="_overlay_1ljew_1",es="_dialog_1ljew_17",ts="_contentBox_1ljew_30",ss="_content_1ljew_30",ns="_title_1ljew_42",as="_description_1ljew_53",is="_buttonGroup_1ljew_65",cs="_buttonGroupLeft_1ljew_71",rs="_buttonGroupRight_1ljew_77",os="_cancelButton_1ljew_113",ls="_confirmButton_1ljew_132",V={overlay:Yt,dialog:es,contentBox:ts,content:ss,title:ns,description:as,buttonGroup:is,buttonGroupLeft:cs,buttonGroupRight:rs,cancelButton:os,confirmButton:ls},ds=({isOpen:t,onConfirm:a,onCancel:d})=>t?e.jsx("div",{className:V.overlay,children:e.jsx("div",{className:V.dialog,children:e.jsxs("div",{className:V.content,children:[e.jsxs("div",{className:V.contentBox,children:[e.jsx("h3",{className:V.title,children:"Á°ÆÂÆöÊ∏ÖÁ©∫ÂÖ®ÈÉ®ÊêúÁ¥¢ÂéÜÂè≤ËÆ∞ÂΩïÂêó?"}),e.jsx("p",{className:V.description,children:"Ê∏ÖÁ©∫ÂêéÂ∞ÜÊó†Ê≥ïÂ§çÂéü,ÊÇ®Â∞ÜÊ∏ÖÁ©∫ÊâÄÊúâËÆ∞ÂΩï"})]}),e.jsxs("div",{className:V.buttonGroup,children:[e.jsx("div",{className:V.buttonGroupLeft,children:e.jsx("button",{type:"button",className:V.cancelButton,onClick:d,children:"ÂèñÊ∂à"})}),e.jsx("div",{className:V.buttonGroupRight,children:e.jsx("button",{type:"button",className:V.confirmButton,onClick:a,children:"Á°ÆÂÆö"})})]})]})})}):null,ms="_container_yeckz_1",hs="_section_yeckz_12",ps="_sectionTitle_yeckz_19",us="_resultList_yeckz_28",gs="_resultItem_yeckz_34",xs="_resultTitle_yeckz_55",ys="_emptyState_yeckz_75",_s="_emptyIcon_yeckz_85",vs="_emptyTitle_yeckz_91",B={container:ms,section:hs,sectionTitle:ps,resultList:us,resultItem:gs,resultTitle:xs,emptyState:ys,emptyIcon:_s,emptyTitle:vs},fs=({query:t,isVisible:a,isLoading:d,onItemClick:i,searchResults:o})=>{if(!a||!t.trim())return null;const j=o.list.filter(r=>r.type===1||r.type===2).map(r=>r.data),b=o.list.filter(r=>r.type===3).map(r=>r.data),I=(r,m)=>{console.log("highlightText:",r,m);const S=m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),h=new RegExp(`(${S})`,"gi"),y=r==null?void 0:r.split(h);return y==null?void 0:y.map((c,p)=>h.test(c)?e.jsx("span",{style:{color:"var(--Primary-5_, #B2FCFF)"},children:c},p):c)};return d?e.jsx("div",{className:B.container,style:{zIndex:1e3,position:"relative"},children:e.jsxs("div",{className:B.emptyState,children:[e.jsx("div",{className:B.emptyIcon,children:"‚è≥"}),e.jsx("h3",{className:B.emptyTitle,children:"Ê≠£Âú®ÊêúÁ¥¢..."})]})}):o.list.length===0&&!d?e.jsx("div",{className:B.container,style:{zIndex:1e3,position:"relative"},children:e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsx(O,{})})}):e.jsxs("div",{className:B.container,style:{zIndex:1e3,position:"relative"},children:[j.length>0&&e.jsxs("div",{className:B.section,children:[e.jsx("h3",{className:B.sectionTitle,children:"Ê∏∏Êàè"}),e.jsx("div",{className:B.resultList,children:j.map(r=>e.jsxs("button",{type:"button",className:B.resultItem,onClick:m=>{m.preventDefault(),m.stopPropagation(),console.log("Game item clicked:",r.name),i==null||i(r)},onTouchEnd:m=>{m.preventDefault(),m.stopPropagation(),console.log("Game item touchend:",r.name),i==null||i(r)},onMouseDown:m=>{m.preventDefault(),console.log("Game item mousedown:",r.name)},onTouchStart:m=>{console.log("Game item touchstart:",r.name)},children:[e.jsx("span",{className:B.resultTitle,children:I(r.name,t)}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[e.jsx("title",{children:"Game Result Link"}),e.jsx("path",{d:"M15 14.1663C15 14.6265 14.6265 15 14.1663 15C13.7062 14.9998 13.3337 14.6264 13.3337 14.1663V7.84424L6.42212 14.7559C6.09669 15.0811 5.56949 15.0812 5.24414 14.7559C4.91879 14.4305 4.91893 13.9033 5.24414 13.5779L12.1558 6.66626H5.83374C5.37363 6.66626 5.00022 6.29379 5 5.83374C5 5.3735 5.37349 5 5.83374 5H14.1663C14.6265 5 15 5.3735 15 5.83374V14.1663Z",fill:"#BAD7F5","fill-opacity":"0.65"})]})]},r.id))})]}),b.length>0&&e.jsxs("div",{className:B.section,children:[e.jsx("h3",{className:B.sectionTitle,children:"Ê¥ªÂä®"}),e.jsx("div",{className:B.resultList,children:b.map(r=>e.jsxs("button",{type:"button",className:B.resultItem,onClick:m=>{m.preventDefault(),m.stopPropagation(),console.log("Activity item clicked:",r.title),i==null||i(r)},onTouchEnd:m=>{m.preventDefault(),m.stopPropagation(),console.log("Activity item touchend:",r.title),i==null||i(r)},onMouseDown:m=>{m.preventDefault(),console.log("Activity item mousedown:",r.title)},onTouchStart:m=>{console.log("Activity item touchstart:",r.title)},children:[e.jsx("span",{className:B.resultTitle,children:I(r.title,t)}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[e.jsx("title",{children:"Activity Result Link"}),e.jsx("path",{d:"M15 14.1663C15 14.6265 14.6265 15 14.1663 15C13.7062 14.9998 13.3337 14.6264 13.3337 14.1663V7.84424L6.42212 14.7559C6.09669 15.0811 5.56949 15.0812 5.24414 14.7559C4.91879 14.4305 4.91893 13.9033 5.24414 13.5779L12.1558 6.66626H5.83374C5.37363 6.66626 5.00022 6.29379 5 5.83374C5 5.3735 5.37349 5 5.83374 5H14.1663C14.6265 5 15 5.3735 15 5.83374V14.1663Z",fill:"#BAD7F5","fill-opacity":"0.65"})]})]},r.id))})]})]})},js="_container_ypp36_2",bs="_content_ypp36_28",Ns="_emptyContainer_ypp36_33",Cs="_tabContainer_ypp36_44",ws="_tab_ypp36_44",Is="_activeTab_ypp36_64",Ls="_waveIcon_ypp36_68",Ts="_gameList_ypp36_94",Ss="_gameItem_ypp36_100",Ds="_gameImage_ypp36_120",Rs="_gameInfo_ypp36_130",Bs="_gameTitle_ypp36_140",$s="_gameMeta_ypp36_155",ks="_ratingContainer_ypp36_165",Ms="_searchIcon_ypp36_171",Hs="_gameRating_ypp36_175",Ps="_noRating_ypp36_180",Es="_tags_ypp36_190",Fs="_tag_ypp36_190",As="_tagSeparator_ypp36_209",zs="_icons_ypp36_220",Gs="_gameDescription_ypp36_245",Us="_bottomText_ypp36_261",Vs="_emptyState_ypp36_271",Ks="_emptyIcon_ypp36_281",Zs="_emptyTitle_ypp36_287",Ws="_emptyDescription_ypp36_295",Os="_activityDescription_ypp36_310",l={container:js,content:bs,emptyContainer:Ns,tabContainer:Cs,tab:ws,activeTab:Is,waveIcon:Ls,gameList:Ts,gameItem:Ss,gameImage:Ds,gameInfo:Rs,gameTitle:Bs,gameMeta:$s,ratingContainer:ks,searchIcon:Ms,gameRating:Hs,noRating:Ps,tags:Es,tag:Fs,tagSeparator:As,icons:zs,gameDescription:Gs,bottomText:Us,emptyState:Vs,emptyIcon:Ks,emptyTitle:Zs,emptyDescription:Ws,activityDescription:Os},qs=({width:t=16,height:a=16,className:d=""})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:a,viewBox:"0 0 16 16",fill:"none",className:d,children:e.jsx("path",{d:"M7.3908 14.064L2.75086 9.42605L1.55969 8.23488C0.901476 7.57641 0.5318 6.68344 0.531982 5.7524C0.532165 4.82137 0.902192 3.92854 1.56066 3.27033C2.21913 2.61212 3.1121 2.24245 4.04313 2.24263C4.97417 2.24281 5.86699 2.61284 6.5252 3.27131L12.9587 9.70484L8.60928 14.064C8.44527 14.221 8.22704 14.3086 8.00004 14.3086C7.77305 14.3086 7.55481 14.221 7.3908 14.064ZM14.4384 8.23488L13.5319 9.14337L8.56249 4.17395C8.56249 4.17395 8.57808 4.17395 8.58393 4.15836L9.47293 3.26936C10.1314 2.61089 11.0245 2.24097 11.9557 2.24097C12.8869 2.24097 13.78 2.61089 14.4384 3.26936C15.0969 3.92783 15.4668 4.8209 15.4668 5.75212C15.4668 6.68333 15.0969 7.57641 14.4384 8.23488Z",fill:"currentColor"})}),je=t=>t?Ae(t).text():"",pe=(t,a)=>{if(!t)return"";let d;return a<=320?d=20:a<=375?d=30:a<=414?d=40:d=50,t.length>d?t.substring(0,d):t},Qs=({query:t})=>{var se;const[a,d]=ue(),i=a.get("tab"),[o,j]=g.useState(i||"game"),[b,I]=g.useState(!1),[r,m]=g.useState(!!i),[S,h]=g.useState(window.innerWidth),y=g.useRef(null),{data:c,fetchNextPage:p,hasNextPage:M,isFetchingNextPage:$,isLoading:R,isError:P,error:N}=ie({queryKey:["mobileSearchResults","game",t],queryFn:async({pageParam:s=1})=>(await q({text:t,page:s,type:1,page_size:10})).data,getNextPageParam:s=>{if(s.list&&s.list.length>0)return s.list.length>0&&s.page*s.page_size<s.total?s.page+1:void 0},enabled:!!t,staleTime:1800*1e3,gcTime:1800*1e3,initialPageParam:1}),{data:C,fetchNextPage:k,hasNextPage:Z,isFetchingNextPage:E,isLoading:X,isError:W,error:oe}=ie({queryKey:["mobileSearchResults","activity",t],queryFn:async({pageParam:s=1})=>(await q({text:t,page:s,type:3,page_size:10})).data,getNextPageParam:s=>{if(s.list&&s.list.length>0)return s.list.length>0&&s.page*s.page_size<s.total?s.page+1:void 0},enabled:!!t,staleTime:1800*1e3,gcTime:1800*1e3,initialPageParam:1}),Y=g.useRef(null),ee=g.useRef(null);g.useEffect(()=>{let s=null,u=null,w=null,F,Q=!1;return o==="game"?(u=Y,w=p,F=M,Q=$):o==="activity"&&(u=ee,w=k,F=Z,Q=E),u&&w&&F!==void 0&&(s=new IntersectionObserver(ne=>{ne[0].isIntersecting&&F&&!Q&&w()},{threshold:.5}),u.current&&s.observe(u.current)),()=>{s&&s.disconnect()}},[o,M,$,p,Z,E,k]);const z=((c==null?void 0:c.pages.flatMap(s=>s.list||[]))||[]).filter(s=>s.type===1||s.type===2).map(s=>s.data),G=((C==null?void 0:C.pages.flatMap(s=>s.list||[]))||[]).filter(s=>s.type===3).map(s=>s.data);g.useEffect(()=>{r||(z.length>0&&G.length===0?(j("game"),m(!0)):z.length===0&&G.length>0?(j("activity"),m(!0)):z.length>0&&G.length>0&&(j("game"),m(!0)))},[z.length,G.length,r]),g.useEffect(()=>{I(!0)},[]),g.useEffect(()=>{const s=()=>{h(window.innerWidth)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),g.useEffect(()=>{const s=a.get("tab");s&&s!==o&&j(s)},[a,o]);const te=s=>{j(s),I(!1),setTimeout(()=>I(!0),0);const u=new URLSearchParams(a);u.set("tab",s),d(u,{replace:!0})};if(R&&!z.length||X&&!G.length)return e.jsx("div",{className:l.container,style:{zIndex:1e3,position:"relative"},children:e.jsxs("div",{className:l.emptyState,children:[e.jsx("div",{className:l.emptyIcon,children:"‚è≥"}),e.jsx("h3",{className:l.emptyTitle,children:"Ê≠£Âú®ÊêúÁ¥¢..."})]})});if(P||W)return e.jsx("div",{className:l.container,style:{zIndex:1e3,position:"relative"},children:e.jsxs("div",{className:l.emptyState,children:[e.jsx("div",{className:l.emptyIcon,children:"‚ùå"}),e.jsx("h3",{className:l.emptyTitle,children:"Âä†ËΩΩÂ§±Ë¥•"}),e.jsx("p",{className:l.emptyDescription,children:((se=N||oe)==null?void 0:se.message)||"Êú™Áü•ÈîôËØØ"})]})});const le=s=>{const u={id:s.id,cover:s.cover_image,title:K(pe(s.name,S),t),description:K(pe(je(s.title_desc||s.description||"ÊöÇÊó†ÊèèËø∞"),S),t),rating:s.review_percentage,tags:Object.values(s.top_category_tags).slice(0,3),platforms:Object.keys(s.filter||[]).filter(w=>w.startsWith("gamePlatform-"))};return e.jsxs(_e,{className:l.gameItem,to:`/game/${u.id}`,children:[e.jsx("div",{className:l.gameImage,children:e.jsx(ve,{src:u.cover,alt:s.name,width:122,height:70})}),e.jsxs("div",{className:l.gameInfo,children:[e.jsx("h3",{className:l.gameTitle,children:u.title}),e.jsxs("div",{className:l.gameMeta,children:[u!=null&&u.rating&&u.rating>=0?e.jsxs("div",{className:l.ratingContainer,children:[e.jsx(qs,{className:l.searchIcon}),e.jsxs("span",{className:l.gameRating,children:[u.rating,"%"]})]}):e.jsx("span",{className:l.noRating,children:"ÊöÇÊó†ËØÑÂàÜ"}),u.tags&&u.tags.length>0?e.jsx("div",{className:l.tags,children:u.tags.map((w,F)=>e.jsxs(ae.Fragment,{children:[e.jsx("span",{className:l.tag,children:w}),F<u.tags.length-1&&e.jsx("span",{className:l.tagSeparator,children:"¬∑"})]},`${u.id}-${w}-${F}`))}):e.jsx("span",{className:l.tag,children:"Ê†áÁ≠æ"}),e.jsx("div",{className:l.icons,children:u.platforms.map(w=>{const F=Ce[w];return F?e.jsx(F,{className:"w-4 h-4 text-b65"},w):null})})]}),e.jsx("p",{className:l.gameDescription,children:u.description})]})]},u.id)},de=(s,u)=>{const w={id:s.id,title:K(s.title,t),description:K(pe(je(s.desc||"ÊöÇÊó†ÊèèËø∞"),S),t)};return e.jsxs(_e,{className:l.gameItem,to:`/special/${w.id}`,children:[e.jsx("div",{className:l.gameImage,children:e.jsx(ve,{src:s.content_img,alt:s.title,width:122,height:70})}),e.jsxs("div",{className:l.gameInfo,children:[e.jsx("h3",{className:l.gameTitle,children:w.title}),e.jsx("p",{className:`${l.gameDescription} ${l.activityDescription}`,children:w.description})]})]},w.id)};return e.jsxs("div",{className:l.container,ref:y,children:[e.jsxs("div",{className:l.tabContainer,children:[z.length>0&&e.jsxs("button",{type:"button",className:`${l.tab} ${o==="game"?l.activeTab:""}`,onClick:()=>te("game"),children:["Ê∏∏Êàè‰∏≠ÂøÉ",o==="game"&&b&&e.jsx(ce,{className:l.waveIcon})]}),G.length>0&&e.jsxs("button",{type:"button",className:`${l.tab} ${o==="activity"?l.activeTab:""}`,onClick:()=>te("activity"),children:["Ê¥ªÂä®‰∏≠ÂøÉ",o==="activity"&&b&&e.jsx(ce,{className:l.waveIcon})]})]}),e.jsxs("div",{className:l.content,children:[o==="game"&&e.jsxs("div",{className:l.gameList,children:[z.map(s=>e.jsx(ae.Fragment,{children:le(s)},s.id)),$&&e.jsx("div",{className:l.loadingMore,children:"Âä†ËΩΩÊõ¥Â§öÊ∏∏Êàè..."}),e.jsx("div",{ref:Y,style:{height:"20px",backgroundColor:"transparent"},"data-debug":"game-load-more"})]}),o==="activity"&&e.jsxs("div",{className:l.gameList,children:[G.map((s,u)=>e.jsx(ae.Fragment,{children:de(s)},s.id)),E&&e.jsx("div",{className:l.loadingMore,children:"Âä†ËΩΩÊõ¥Â§öÊ¥ªÂä®..."}),e.jsx("div",{ref:ee,style:{height:"20px",backgroundColor:"transparent"},"data-debug":"activity-load-more"})]}),!z.length&&!G.length&&!R&&!X&&e.jsx("div",{className:l.emptyContainer,children:e.jsx(O,{})})]}),o==="game"&&!M&&z.length>0&&e.jsx("div",{className:l.bottomText,children:"Â∑≤ÁªèÂà∞Â∫ïÂï¶ÔΩû"}),o==="activity"&&!Z&&G.length>0&&e.jsx("div",{className:l.bottomText,children:"Â∑≤ÁªèÂà∞Â∫ïÂï¶ÔΩû"})]})};function Js(t,a){const[d,i]=g.useState(t);return g.useEffect(()=>{const o=setTimeout(()=>i(t),a);return()=>{clearTimeout(o)}},[t,a]),d}const Xs=()=>{const[t]=ue(),a=re(),d=Ie(),i=t.get("q")||"",o=!!Le(n=>n.auth.token),{history:j,addHistory:b,deleteHistory:I,clearHistory:r}=Te(),{data:m=[]}=J({queryKey:["searchHistory"],queryFn:async()=>(await Me()).data,enabled:o,select:n=>n.map(_=>_.search_text)}),S=o?m:j,[h,y]=g.useState(!1),[c,p]=g.useState(!1),[M,$]=g.useState(i),R=Js(M,800),[P,N]=g.useState(null),C=g.useRef(null),k=g.useRef(null);ae.useEffect(()=>{$(i)},[i]);const{data:Z=[]}=J({queryKey:["recommends"],queryFn:async()=>(await He()).data,staleTime:900*1e3}),{data:E}=J({queryKey:["underword"],queryFn:async()=>(await Pe()).data,refetchInterval:5e3}),X=g.useMemo(()=>{const n=(E==null?void 0:E.text)||"ÊêúÁ¥¢Ê∏∏Êàè„ÄÅÊ¥ªÂä®...",_=20;return n.length>_?n.substring(0,_)+"...":n},[E==null?void 0:E.text]),W=me({mutationFn:Se,onSuccess:()=>{d.invalidateQueries({queryKey:["searchHistory"]})}}),{data:oe,isLoading:Y}=J({queryKey:["searchResults",R],queryFn:async({signal:n})=>{const _=await q({text:R},{signal:n});return o?W.mutate({text:R}):b(R),_.data},enabled:!!R,staleTime:1800*1e3}),ee=()=>{y(!0)},ge=me({mutationFn:o?De:async()=>(r(),{code:200,data:null,message:"success"}),onMutate:async()=>{if(o){await d.cancelQueries({queryKey:["searchHistory"]});const n=d.getQueryData(["searchHistory"]);return d.setQueryData(["searchHistory"],[]),{previousSearchHistory:n}}return{}},onError:(n,_,v)=>{o&&(v!=null&&v.previousSearchHistory)&&d.setQueryData(["searchHistory"],v.previousSearchHistory)},onSuccess:()=>{y(!1)},onSettled:()=>{o&&d.invalidateQueries({queryKey:["searchHistory"]})}}),z=()=>{ge.mutate()},xe=()=>{y(!1)},G=()=>{p(!0)},te=()=>{setTimeout(()=>{p(!1)},100)},le=n=>{$(n.target.value)},de=n=>{var _;if(n.key==="Escape")$("");else if(n.key==="Enter"){const v=M.trim()||(E==null?void 0:E.text)||"";if(!v)return;n.preventDefault(),o?W.mutate({text:v}):b(v),p(!1),(_=C.current)==null||_.blur(),a(`/results?q=${encodeURIComponent(v)}`),setTimeout(()=>{},100)}},se=(n,_,v)=>{const A=`${_}_${v}_${n}`;N(A)},s=(n,_,v)=>{k.current=setTimeout(()=>{se(n,_,v)},500)},u=()=>{k.current&&(clearTimeout(k.current),k.current=null)},w=()=>{k.current&&(clearTimeout(k.current),k.current=null)},F=()=>{N(null)},Q=me({mutationFn:n=>Re(n),onSuccess:()=>{d.invalidateQueries({queryKey:["searchHistory"]})}}),ne=(n,_,v)=>{_==="history"&&(I(n),o&&Q.mutate(n.id)),_==="recommend"&&console.log("Âà†Èô§Êé®ËçêÈ°πÁõÆ:",v),N(null)};return e.jsxs("div",{className:`${x.container} ${c?x.searchFocused:""}`,"data-mobile-search":!0,onClick:F,onKeyDown:n=>{n.key==="Enter"&&F()},role:"button",tabIndex:0,children:[e.jsxs("div",{className:x.headerBox,children:[e.jsx("div",{className:x.backButtons,children:e.jsx("button",{type:"button",className:x.backButton,onClick:()=>a(-1),children:e.jsx(Jt,{color:"#BAD7F5"})})}),e.jsx("div",{className:x.searchBox,children:e.jsxs("div",{className:`${x.searchBar} ${c?x.searchBarFocused:""}`,children:[c?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:x.searchIcon,children:[e.jsx("title",{children:"Search Icon"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.333 7.33301C13.333 8.74915 12.8399 10.0501 12.0195 11.0762L14.4717 13.5283C14.732 13.7886 14.732 14.2113 14.4717 14.4717C14.2113 14.732 13.7887 14.732 13.5283 14.4717L11.0762 12.0195C10.0501 12.8399 8.74916 13.333 7.33301 13.333C4.01944 13.3328 1.33301 10.6466 1.33301 7.33301C1.33319 4.01956 4.01955 1.33317 7.33301 1.33301C10.6466 1.33301 13.3328 4.01946 13.333 7.33301ZM12 7.33301C11.9998 4.75584 9.91023 2.66699 7.33301 2.66699C4.75593 2.66716 2.66717 4.75594 2.66699 7.33301C2.66699 9.91024 4.75582 11.9998 7.33301 12C8.62187 12 9.78761 11.4781 10.6328 10.6328C11.4781 9.78761 12 8.62187 12 7.33301Z",fill:"#BAD7F5"})]}):e.jsx("img",{src:Be,className:x.searchIcon,alt:"search"}),e.jsx("input",{ref:C,type:"text",className:x.searchInput,placeholder:X,value:M,onChange:le,onFocus:G,onBlur:te,onKeyDown:de,style:{zIndex:1e3,position:"relative"}}),c&&M&&e.jsx("button",{type:"button",className:x.clearButton,onClick:n=>{n.stopPropagation(),n.preventDefault(),$("")},onMouseDown:n=>{n.stopPropagation(),n.preventDefault()},style:{cursor:"pointer",pointerEvents:"auto"},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("title",{children:"Clear Search"}),e.jsx("path",{d:"M9.52832 5.52832C9.78868 5.26799 10.2113 5.26798 10.4717 5.52832C10.732 5.78866 10.732 6.21133 10.4717 6.47168L8.94336 8L10.4717 9.52832C10.732 9.78867 10.732 10.2113 10.4717 10.4717C10.2113 10.732 9.78867 10.732 9.52832 10.4717L8 8.94336L6.47168 10.4717C6.21133 10.732 5.78867 10.732 5.52832 10.4717C5.26797 10.2113 5.26797 9.78867 5.52832 9.52832L7.05664 8L5.52832 6.47168C5.26797 6.21133 5.26797 5.78867 5.52832 5.52832C5.78867 5.26799 6.21133 5.26798 6.47168 5.52832L8 7.05664L9.52832 5.52832Z",fill:"#BAD7F5",fillOpacity:"0.4"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 1.33301C11.6819 1.33302 14.667 4.31811 14.667 8C14.667 11.6819 11.6819 14.667 8 14.667C4.3181 14.667 1.33301 11.6819 1.33301 8C1.33301 4.3181 4.3181 1.33301 8 1.33301ZM8 2.66699C5.05448 2.66699 2.667 5.05448 2.66699 8C2.66699 10.9455 5.05448 13.333 8 13.333C10.9455 13.333 13.333 10.9455 13.333 8C13.333 5.05449 10.9455 2.667 8 2.66699Z",fill:"#BAD7F5",fillOpacity:"0.4"})]})})]})})]}),c&&M.trim()?e.jsx(fs,{query:R,isVisible:!0,isLoading:Y,onItemClick:n=>{var _;if(p(!1),(_=C.current)==null||_.blur(),"name"in n&&n.id)a(`/game/${n.id}`);else if("title"in n&&n.id)a(`/special/${n.id}`);else{const v="name"in n?n.name:"title"in n?n.title:"Unknown item";a(`/results?q=${encodeURIComponent(v)}`)}},searchResults:oe||{list:[]}}):i?e.jsx(Qs,{query:i}):!i&&!c?e.jsxs(e.Fragment,{children:[S&&S.length>0&&e.jsxs("div",{className:x.searchHistory,children:[e.jsxs("div",{className:x.historyHeader,children:[e.jsx("h3",{className:x.historyTitle,children:"ÂéÜÂè≤ÊêúÁ¥¢"}),e.jsx("button",{type:"button",className:x.deleteButton,onClick:ee,children:e.jsx(Xt,{color:"#BAD7F5"})})]}),e.jsx("div",{className:x.historyList,children:S.map((n,_)=>{const v=typeof n=="string"?n:n.search_text,A=`history_${_}_${v}`;return e.jsxs("div",{className:x.tagWrapper,children:[e.jsx("button",{type:"button",className:x.historyItem,onMouseDown:U=>{U.preventDefault(),U.stopPropagation(),s(v,"history",_)},onMouseUp:u,onMouseLeave:w,onClick:U=>{var ye;U.preventDefault(),U.stopPropagation(),P===A||(o?W.mutate({text:v}):b(v),p(!1),(ye=C.current)==null||ye.blur(),a(`/results?q=${encodeURIComponent(v)}`))},children:v}),P===A&&e.jsx("button",{type:"button",className:x.deleteIcon,onClick:U=>{U.preventDefault(),U.stopPropagation(),ne(n,"history",_)},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:[e.jsx("title",{children:"Delete Item"}),e.jsx("path",{d:"M7 1.16602C10.2216 1.16603 12.834 3.77835 12.834 7C12.834 10.2216 10.2216 12.834 7 12.834C3.77834 12.834 1.16602 10.2216 1.16602 7C1.16602 3.77834 3.77834 1.16602 7 1.16602ZM9.16309 4.83691C8.93528 4.60912 8.56472 4.60913 8.33691 4.83691L7 6.1748L5.66309 4.83691C5.43528 4.60912 5.06472 4.60912 4.83691 4.83691C4.60911 5.06472 4.60912 5.43528 4.83691 5.66309L6.1748 7L4.83691 8.33691C4.60911 8.56472 4.60912 8.93528 4.83691 9.16309C5.06472 9.39088 5.43528 9.39088 5.66309 9.16309L7 7.8252L8.33691 9.16309C8.56472 9.39088 8.93528 9.39088 9.16309 9.16309C9.39087 8.93528 9.39088 8.56472 9.16309 8.33691L7.8252 7L9.16309 5.66309C9.39087 5.43528 9.39088 5.06472 9.16309 4.83691Z",fill:"#BAD7F5"})]})})]},v)})})]}),e.jsxs("div",{className:x.gameRecommendations,children:[e.jsxs("div",{className:x.recommendationsHeader,children:[e.jsx("h3",{className:x.recommendationsTitle,children:"Ê∏∏ÊàèÊé®Ëçê"}),e.jsxs("button",{type:"button",className:x.refreshBtn,onClick:n=>{n.preventDefault(),n.stopPropagation(),d.invalidateQueries({queryKey:["recommends"]})},children:[e.jsx($e,{className:x.refreshIcon}),e.jsx("span",{children:"Êç¢‰∏ÄÊç¢"})]})]}),e.jsx("div",{className:x.recommendationsList,children:Z&&ke(Z).map((n,_)=>{const v=`recommend_${_}_${n.text}`;return e.jsxs("div",{className:x.tagWrapper,children:[e.jsx("button",{type:"button",className:x.recommendationItem,onMouseDown:A=>{A.preventDefault(),A.stopPropagation(),s(n.text,"recommend",_)},onMouseUp:u,onMouseLeave:w,onClick:A=>{var U;A.preventDefault(),A.stopPropagation(),P===v?console.log("ÈïøÊåâÁä∂ÊÄÅÁöÑÊé®ËçêÈ°πÁõÆË¢´ÁÇπÂáªÔºå‰øùÊåÅÂõæÊ†áÊòæÁ§∫"):(console.log("Recommendation item clicked:",n.text),p(!1),(U=C.current)==null||U.blur(),n.content_type===1?a(`/game/${n.content_id}`):n.content_type===2?a(`/special/${n.content_id}`):(o?W.mutate({text:n.text}):b(n.text),a(`/results?q=${encodeURIComponent(n.text)}`)))},children:n.text}),P===v&&e.jsx("button",{type:"button",className:x.deleteIcon,onClick:A=>{A.preventDefault(),A.stopPropagation(),ne(n,"recommend",_)},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:[e.jsx("title",{children:"Delete Recommendation"}),e.jsx("path",{d:"M7 1.16602C10.2216 1.16603 12.834 3.77835 12.834 7C12.834 10.2216 10.2216 12.834 7 12.834C3.77834 12.834 1.16602 10.2216 1.16602 7C1.16602 3.77834 3.77834 1.16602 7 1.16602ZM9.16309 4.83691C8.93528 4.60912 8.56472 4.60913 8.33691 4.83691L7 6.1748L5.66309 4.83691C5.43528 4.60912 5.06472 4.60912 4.83691 4.83691C4.60911 5.06472 4.60912 5.43528 4.83691 5.66309L6.1748 7L4.83691 8.33691C4.60911 8.56472 4.60912 8.93528 4.83691 9.16309C5.06472 9.39088 5.43528 9.39088 5.66309 9.16309L7 7.8252L8.33691 9.16309C8.56472 9.39088 8.93528 9.39088 9.16309 9.16309C9.39087 8.93528 9.39088 8.56472 9.16309 8.33691L7.8252 7L9.16309 5.66309C9.39087 5.43528 9.39088 5.06472 9.16309 4.83691Z",fill:"#BAD7F5"})]})})]},n.id)})})]})]}):null,e.jsx(ds,{isOpen:h,onConfirm:z,onCancel:xe})]})},on=()=>{const[t,a]=ue(),d=t.get("tab")||"game",[i,o]=g.useState(d),[j,b]=g.useState(!1),[I,r]=g.useState(!1),m=t.get("q")||"",S=N=>{o(N);const C=new URLSearchParams(t);C.set("tab",N),a(C,{replace:!0})},{data:h,isLoading:y,isError:c}=J({queryKey:["searchResults",m],queryFn:async({signal:N})=>{if(!m.trim())return{list:[],page:0,page_size:0,total:0};const C=await q({text:m},{signal:N});if(C.code===200)return C.data;throw new Error("Search failed")},enabled:!!m.trim(),staleTime:1e3*60*30}),p=(h==null?void 0:h.list)||[],M=(h==null?void 0:h.total)||0,$=p.filter(N=>N.type===1||N.type===2),R=p.filter(N=>N.type===3),P=i==="game"?$:R;return g.useEffect(()=>{const N=p.filter(k=>k.type===1||k.type===2).length,C=p.filter(k=>k.type===3).length;N===0&&C>0&&o("activity")},[p]),g.useEffect(()=>{const N=()=>{const C=window.innerWidth<1e3;b(C)};return N(),window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N)}},[]),g.useEffect(()=>{r(!0)},[]),j?e.jsx(Xs,{}):y?e.jsxs("div",{children:[e.jsx("div",{className:f.lightEffect1}),e.jsx("div",{className:f.header,children:e.jsxs("div",{className:f.headerContent,children:[e.jsx(T,{width:Math.max(200,Math.min(500,200+((m==null?void 0:m.length)||0)*15)),height:46,style:{borderRadius:"8px"}}),e.jsx(T,{width:Math.max(200,Math.min(400,200+((m==null?void 0:m.length)||0)*8)),height:16,style:{borderRadius:"4px"}})]})}),e.jsxs("div",{className:f.tabContainer,children:[e.jsx(T,{width:64,height:22,style:{borderRadius:"20px"}}),e.jsx(T,{width:64,height:22,style:{borderRadius:"20px"}})]}),e.jsx("div",{className:f.contentArea,children:e.jsx("div",{style:{width:"100%",padding:"20px 0"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0",width:"100%"},children:[(console.log("isLoading Debug:"),console.log("activeTab:",i),console.log("currentResults:",P),console.log("currentResults.length:",P.length),console.log("gameResults:",$),console.log("activityResults:",R),console.log("Skeleton count:",P.length>0?P.length:8),null),Array.from({length:P.length>0?P.length:8}).map((N,C)=>e.jsxs("div",{style:{display:"flex",padding:"20px",alignItems:"center",gap:"20px",width:"100%",transition:"all 0.3s ease",cursor:"pointer",background:"transparent",position:"relative",zIndex:1,boxSizing:"border-box",margin:0,flex:1},children:[e.jsx("div",{style:{flexShrink:0},children:e.jsx(T,{width:122,height:70,style:{borderRadius:"8px"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",flex:1,justifyContent:"flex-start",alignItems:"flex-start"},children:[e.jsx(T,{width:204,height:20,style:{borderRadius:"4px"}}),i==="game"&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px"},children:e.jsx(T,{width:312,height:16})}),e.jsx(T,{width:i==="game"?456:312,height:16,style:{borderRadius:"4px"}})]})]},`skeleton-${C}`))]})})}),e.jsx(T,{width:120,height:20,style:{margin:"20px auto"}})]}):c?e.jsx("div",{className:"min-h-[calc(100%-180px)] relative",children:e.jsxs("div",{className:f.emptyState,children:[e.jsx("div",{className:f.emptyIcon,children:"üò¢"}),e.jsx("h3",{className:f.emptyTitle,children:"ÊêúÁ¥¢Â§±Ë¥•"}),e.jsx("p",{className:f.emptyDescription,children:"ËØ∑Á®çÂêéÂÜçËØïÔºåÊàñÊ£ÄÊü•ÁΩëÁªúËøûÊé•"})]})}):e.jsxs("div",{className:"h-[calc(100%-180px)] relative",children:[e.jsx("div",{className:f.lightEffect1}),e.jsx("div",{className:f.header,children:e.jsxs("div",{className:f.headerContent,children:[e.jsxs("h1",{className:f.title,children:["ÊêúÁ¥¢ÁªìÊûú '",m,"'"]}),e.jsxs("div",{className:f.searchInfo,children:[e.jsxs("span",{className:f.searchDescription,children:["Áõ∏ÂÖ≥ÁªìÊûúÂ¶Ç‰∏ãÔºåÊâæÂà∞",M,"‰∏™ÁªìÊûú"]}),e.jsx(Ee,{width:16,height:16,color:"#BAD7F5",opacity:.65,style:{marginLeft:"5px"}})]})]})}),p.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f.tabContainer,children:[e.jsxs("button",{type:"button",className:`${f.tabButton} ${i==="game"?f.active:""}`,onClick:()=>{S("game"),r(!1),setTimeout(()=>r(!0),0)},children:["Ê∏∏Êàè‰∏≠ÂøÉ",i==="game"&&I&&e.jsx(ce,{className:f.waveIcon})]}),e.jsxs("button",{type:"button",className:`${f.tabButton} ${i==="activity"?f.active:""}`,onClick:()=>{S("activity"),r(!1),setTimeout(()=>r(!0),0)},children:["Ê¥ªÂä®‰∏≠ÂøÉ",i==="activity"&&I&&e.jsx(ce,{className:f.waveIcon})]})]}),i==="game"&&$.length===0&&e.jsx("div",{className:f.emptyContainer,children:e.jsx(O,{})}),i==="game"&&$.length>0&&e.jsx("div",{className:f.contentArea,children:i==="game"&&$.length>0&&e.jsx(yt,{query:m})}),i==="activity"&&R.length===0&&e.jsx("div",{className:f.emptyContainer,children:e.jsx(O,{})}),i==="activity"&&R.length>0&&e.jsx("div",{className:f.contentArea,children:i==="activity"&&R.length>0&&e.jsx(It,{query:m})}),(i==="game"&&$.length>0||i==="activity"&&R.length>0)&&e.jsx("div",{className:f.bottomText,children:"Â∑≤ÁªèÂà∞Â∫ïÂï¶ÔΩû"})]}):e.jsx("div",{className:f.emptyContainer,children:e.jsx(O,{})})]})};export{on as default};
